======================================================================
KAGGLE CONFIGURATION
======================================================================
CSV Path: /kaggle/working/kd-research/dataframes/kaggle-adaptive_median_gpu.csv
Base Path: /kaggle/input/flame2/adaptive-median-gpu/adaptive-median-gpu
Output Dir: /kaggle/working/kd_results
Batch Size: 64
Teacher Epochs: 50
Student Epochs: 30
Seeds: [42]
======================================================================

======================================================================
Training: swin-tiny with kl_bce
Script: /kaggle/working/kd-research/scripts/swin-tiny/train_kd_kl_bce.py
======================================================================

Command: python /kaggle/working/kd-research/scripts/swin-tiny/train_kd_kl_bce.py --csv /kaggle/working/kd-research/dataframes/kaggle-adaptive_median_gpu.csv --base_path /kaggle/input/flame2/adaptive-median-gpu/adaptive-median-gpu --output /kaggle/working/kd_results --seeds 42 --epochs_teacher 50 --epochs_student 30 --batch_size 64 --kd_temperature 2.0 --patience_teacher 999 --patience_student 999

2025-12-07 12:12:15.055431: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1765109535.077233     628 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1765109535.083733     628 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
================================================================================
KNOWLEDGE DISTILLATION PIPELINE - SWIN TRANSFORMER TINY TEACHER
================================================================================
CSV: /kaggle/working/kd-research/dataframes/kaggle-adaptive_median_gpu.csv
Seeds: [42]
Teacher epochs: 50, Student epochs: 30
Batch size: 64
================================================================================

================================================================================
SEED 42
================================================================================
Using device: cuda

--------------------------------------------------------------------------------
DATA PREPARATION
--------------------------------------------------------------------------------
Total frames: 53451
Unique videos: 23

Video-level label distribution:
  No Fire, No Smoke: 5 videos
  Fire, No Smoke: 9 videos
  Fire, Smoke: 9 videos

============================================================
Video-Aware Split Results:
============================================================
Train:  20708 frames from   11 videos ( 38.7%)
Val:    13073 frames from    5 videos ( 24.5%)
Test:   19670 frames from    7 videos ( 36.8%)
============================================================
✓ No video leakage detected

Frame-level label distribution:
  Train: Fire=12488 ( 60.3%), Smoke= 6024 ( 29.1%)
  Val  : Fire=10333 ( 79.0%), Smoke= 9905 ( 75.8%)
  Test : Fire=16930 ( 86.1%), Smoke= 9506 ( 48.3%)

--------------------------------------------------------------------------------
TEACHER TRAINING (Multimodal Swin Transformer Tiny)
--------------------------------------------------------------------------------
Teacher parameters: 56,220,662 (trainable: 55,761,482)
Training teacher model for 50 epochs...

Epoch 1/50
Training: 100%|████████████████| 324/324 [05:36<00:00,  1.04s/it, loss=0.000133]
Validating: 100%|█████████████████████████████| 205/205 [01:20<00:00,  2.55it/s]
Train Loss: 0.0224
Val Loss: 0.0406, Acc: 0.9892, F1: 0.9964, F1 Fire: 1.0000, F1 Smoke: 0.9928
✓ Saved best model (F1: 0.9964)

Epoch 2/50
Training: 100%|█████████████████| 324/324 [05:10<00:00,  1.04it/s, loss=0.00123]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0053
Val Loss: 0.0535, Acc: 0.9846, F1: 0.9949, F1 Fire: 1.0000, F1 Smoke: 0.9897

Epoch 3/50
Training: 100%|█████████████████| 324/324 [05:14<00:00,  1.03it/s, loss=0.00606]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0032
Val Loss: 0.0776, Acc: 0.9775, F1: 0.9925, F1 Fire: 1.0000, F1 Smoke: 0.9849

Epoch 4/50
Training: 100%|████████████████| 324/324 [05:11<00:00,  1.04it/s, loss=0.000186]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0041
Val Loss: 0.0541, Acc: 0.9833, F1: 0.9944, F1 Fire: 1.0000, F1 Smoke: 0.9889

Epoch 5/50
Training: 100%|█████████████████| 324/324 [05:09<00:00,  1.05it/s, loss=0.00016]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0054
Val Loss: 0.0275, Acc: 0.9881, F1: 0.9960, F1 Fire: 1.0000, F1 Smoke: 0.9921

Epoch 6/50
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0019
Val Loss: 0.0890, Acc: 0.9728, F1: 0.9909, F1 Fire: 1.0000, F1 Smoke: 0.9817

Epoch 7/50
Training: 100%|████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=0.000346]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0015
Val Loss: 0.0629, Acc: 0.9764, F1: 0.9921, F1 Fire: 1.0000, F1 Smoke: 0.9842

Epoch 8/50
Training: 100%|████████████████| 324/324 [05:10<00:00,  1.04it/s, loss=0.000102]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0009
Val Loss: 0.0567, Acc: 0.9832, F1: 0.9944, F1 Fire: 1.0000, F1 Smoke: 0.9888

Epoch 9/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=1.22e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0011
Val Loss: 0.0639, Acc: 0.9767, F1: 0.9922, F1 Fire: 1.0000, F1 Smoke: 0.9844

Epoch 10/50
Training: 100%|█████████████████| 324/324 [05:10<00:00,  1.04it/s, loss=1.71e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0008
Val Loss: 0.0979, Acc: 0.9726, F1: 0.9908, F1 Fire: 1.0000, F1 Smoke: 0.9816

Epoch 11/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=5.79e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0010
Val Loss: 0.0616, Acc: 0.9777, F1: 0.9925, F1 Fire: 1.0000, F1 Smoke: 0.9850

Epoch 12/50
Training: 100%|█████████████████| 324/324 [05:16<00:00,  1.02it/s, loss=7.26e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0009
Val Loss: 0.0449, Acc: 0.9830, F1: 0.9943, F1 Fire: 1.0000, F1 Smoke: 0.9887

Epoch 13/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=3.09e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0010
Val Loss: 0.0539, Acc: 0.9802, F1: 0.9934, F1 Fire: 1.0000, F1 Smoke: 0.9868

Epoch 14/50
Training: 100%|██████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=0.0268]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0007
Val Loss: 0.0770, Acc: 0.9773, F1: 0.9924, F1 Fire: 1.0000, F1 Smoke: 0.9848

Epoch 15/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=1.61e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0004
Val Loss: 0.0657, Acc: 0.9833, F1: 0.9944, F1 Fire: 1.0000, F1 Smoke: 0.9889

Epoch 16/50
Training: 100%|████████████████| 324/324 [05:15<00:00,  1.03it/s, loss=0.000142]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0006
Val Loss: 0.0393, Acc: 0.9895, F1: 0.9965, F1 Fire: 1.0000, F1 Smoke: 0.9930
✓ Saved best model (F1: 0.9965)

Epoch 17/50
Training: 100%|██████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=4.6e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0006
Val Loss: 0.0891, Acc: 0.9703, F1: 0.9900, F1 Fire: 1.0000, F1 Smoke: 0.9800

Epoch 18/50
Training: 100%|█████████████████| 324/324 [05:11<00:00,  1.04it/s, loss=1.18e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0575, Acc: 0.9827, F1: 0.9942, F1 Fire: 1.0000, F1 Smoke: 0.9885

Epoch 19/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=1.35e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0007
Val Loss: 0.0984, Acc: 0.9574, F1: 0.9855, F1 Fire: 1.0000, F1 Smoke: 0.9711

Epoch 20/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=1.79e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0006
Val Loss: 0.0538, Acc: 0.9849, F1: 0.9950, F1 Fire: 1.0000, F1 Smoke: 0.9899

Epoch 21/50
Training: 100%|██████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=9.2e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0008
Val Loss: 0.0484, Acc: 0.9875, F1: 0.9959, F1 Fire: 1.0000, F1 Smoke: 0.9917

Epoch 22/50
Training: 100%|████████████████| 324/324 [05:10<00:00,  1.04it/s, loss=0.000142]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0006
Val Loss: 0.1602, Acc: 0.9658, F1: 0.9885, F1 Fire: 1.0000, F1 Smoke: 0.9769

Epoch 23/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=2.33e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0004
Val Loss: 0.0776, Acc: 0.9797, F1: 0.9932, F1 Fire: 1.0000, F1 Smoke: 0.9864

Epoch 24/50
Training: 100%|█████████████████| 324/324 [05:15<00:00,  1.03it/s, loss=4.17e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0003
Val Loss: 0.1030, Acc: 0.9759, F1: 0.9919, F1 Fire: 1.0000, F1 Smoke: 0.9838

Epoch 25/50
Training: 100%|█████████████████| 324/324 [05:11<00:00,  1.04it/s, loss=1.36e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0004
Val Loss: 0.0686, Acc: 0.9826, F1: 0.9942, F1 Fire: 1.0000, F1 Smoke: 0.9884

Epoch 26/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=2.16e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0766, Acc: 0.9815, F1: 0.9938, F1 Fire: 1.0000, F1 Smoke: 0.9876

Epoch 27/50
Training: 100%|█████████████████| 324/324 [05:15<00:00,  1.03it/s, loss=1.07e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0004
Val Loss: 0.0937, Acc: 0.9767, F1: 0.9922, F1 Fire: 1.0000, F1 Smoke: 0.9844

Epoch 28/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=2.12e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0896, Acc: 0.9738, F1: 0.9912, F1 Fire: 1.0000, F1 Smoke: 0.9824

Epoch 29/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=1.34e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0001
Val Loss: 0.0625, Acc: 0.9789, F1: 0.9929, F1 Fire: 1.0000, F1 Smoke: 0.9859

Epoch 30/50
Training: 100%|█████████████████| 324/324 [05:14<00:00,  1.03it/s, loss=4.18e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0004
Val Loss: 0.1037, Acc: 0.9704, F1: 0.9900, F1 Fire: 1.0000, F1 Smoke: 0.9801

Epoch 31/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=1.72e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0712, Acc: 0.9784, F1: 0.9928, F1 Fire: 1.0000, F1 Smoke: 0.9856

Epoch 32/50
Training: 100%|█████████████████| 324/324 [05:14<00:00,  1.03it/s, loss=5.22e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0002
Val Loss: 0.0516, Acc: 0.9836, F1: 0.9945, F1 Fire: 1.0000, F1 Smoke: 0.9890

Epoch 33/50
Training: 100%|█████████████████| 324/324 [05:14<00:00,  1.03it/s, loss=2.71e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0002
Val Loss: 0.0839, Acc: 0.9736, F1: 0.9911, F1 Fire: 1.0000, F1 Smoke: 0.9823

Epoch 34/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=4.28e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0001
Val Loss: 0.0582, Acc: 0.9825, F1: 0.9942, F1 Fire: 1.0000, F1 Smoke: 0.9883

Epoch 35/50
Training: 100%|█████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=2.92e-5]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0002
Val Loss: 0.0559, Acc: 0.9834, F1: 0.9945, F1 Fire: 1.0000, F1 Smoke: 0.9889

Epoch 36/50
Training: 100%|█████████████████| 324/324 [05:16<00:00,  1.02it/s, loss=1.99e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0002
Val Loss: 0.0661, Acc: 0.9811, F1: 0.9937, F1 Fire: 1.0000, F1 Smoke: 0.9874

Epoch 37/50
Training: 100%|████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=0.000154]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0777, Acc: 0.9780, F1: 0.9927, F1 Fire: 1.0000, F1 Smoke: 0.9853

Epoch 38/50
Training: 100%|█████████████████| 324/324 [05:11<00:00,  1.04it/s, loss=1.51e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0003
Val Loss: 0.0726, Acc: 0.9803, F1: 0.9934, F1 Fire: 1.0000, F1 Smoke: 0.9868

Epoch 39/50
Training: 100%|█████████████████| 324/324 [05:12<00:00,  1.04it/s, loss=1.24e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0001
Val Loss: 0.0729, Acc: 0.9810, F1: 0.9937, F1 Fire: 1.0000, F1 Smoke: 0.9873

Epoch 40/50
Training: 100%|█████████████████| 324/324 [05:13<00:00,  1.03it/s, loss=7.26e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0002
Val Loss: 0.0830, Acc: 0.9795, F1: 0.9931, F1 Fire: 1.0000, F1 Smoke: 0.9863

Epoch 41/50
Training: 100%|█████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=3.94e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0001
Val Loss: 0.0803, Acc: 0.9801, F1: 0.9934, F1 Fire: 1.0000, F1 Smoke: 0.9867

Epoch 42/50
Training: 100%|█████████████████| 324/324 [05:16<00:00,  1.02it/s, loss=2.82e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0001
Val Loss: 0.0776, Acc: 0.9806, F1: 0.9935, F1 Fire: 1.0000, F1 Smoke: 0.9870

Epoch 43/50
Training: 100%|█████████████████| 324/324 [05:18<00:00,  1.02it/s, loss=2.93e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0001
Val Loss: 0.0875, Acc: 0.9787, F1: 0.9929, F1 Fire: 1.0000, F1 Smoke: 0.9857

Epoch 44/50
Training: 100%|█████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=4.15e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0002
Val Loss: 0.0772, Acc: 0.9797, F1: 0.9932, F1 Fire: 1.0000, F1 Smoke: 0.9864

Epoch 45/50
Training: 100%|██████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=2.8e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0002
Val Loss: 0.0844, Acc: 0.9787, F1: 0.9929, F1 Fire: 1.0000, F1 Smoke: 0.9858

Epoch 46/50
Training: 100%|█████████████████| 324/324 [05:17<00:00,  1.02it/s, loss=7.01e-8]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0000
Val Loss: 0.0802, Acc: 0.9796, F1: 0.9932, F1 Fire: 1.0000, F1 Smoke: 0.9863

Epoch 47/50
Training: 100%|█████████████████| 324/324 [05:18<00:00,  1.02it/s, loss=3.12e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0001
Val Loss: 0.0836, Acc: 0.9793, F1: 0.9931, F1 Fire: 1.0000, F1 Smoke: 0.9861

Epoch 48/50
Training: 100%|█████████████████| 324/324 [05:19<00:00,  1.01it/s, loss=1.93e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0001
Val Loss: 0.0854, Acc: 0.9787, F1: 0.9929, F1 Fire: 1.0000, F1 Smoke: 0.9858

Epoch 49/50
Training: 100%|█████████████████| 324/324 [05:18<00:00,  1.02it/s, loss=1.12e-6]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.17it/s]
Train Loss: 0.0003
Val Loss: 0.0899, Acc: 0.9780, F1: 0.9927, F1 Fire: 1.0000, F1 Smoke: 0.9853

Epoch 50/50
Training: 100%|██████████████████| 324/324 [05:18<00:00,  1.02it/s, loss=3.2e-7]
Validating: 100%|█████████████████████████████| 205/205 [01:04<00:00,  3.18it/s]
Train Loss: 0.0001
Val Loss: 0.0908, Acc: 0.9780, F1: 0.9926, F1 Fire: 1.0000, F1 Smoke: 0.9853
Teacher training completed in 22205.51s
Saved training curves to /kaggle/working/kd_results/graphs/swin-tiny/run_seed_42/teacher_training_curves.png

--------------------------------------------------------------------------------
STUDENT TRAINING (Lightweight CNN with Knowledge Distillation)
--------------------------------------------------------------------------------
Student parameters: 4,821,058 (trainable: 4,821,058)
Training student model with KL+BCE for 30 epochs...
Loss weights: alpha=0.7 (KL), beta=0.3 (BCE)

Epoch 1/30
Training Student (KL+BCE): 100%|█| 324/324 [07:21<00:00,  1.36s/it, loss=0.594, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5659 (KL: 0.6824, BCE: 0.2940)
Val Loss: 0.3440, Acc: 0.7453, F1: 0.8990, F1 Fire: 1.0000, F1 Smoke: 0.7979
✓ Saved best student model (F1: 0.8990)

Epoch 2/30
Training Student (KL+BCE): 100%|█| 324/324 [07:19<00:00,  1.36s/it, loss=0.623, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5561 (KL: 0.6860, BCE: 0.2529)
Val Loss: 0.4949, Acc: 0.7258, F1: 0.8751, F1 Fire: 0.8845, F1 Smoke: 0.8657

Epoch 3/30
Training Student (KL+BCE): 100%|█| 324/324 [07:19<00:00,  1.36s/it, loss=0.508, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.84it/s]
Train Loss: 0.5532 (KL: 0.6858, BCE: 0.2438)
Val Loss: 0.2730, Acc: 0.9765, F1: 0.9921, F1 Fire: 1.0000, F1 Smoke: 0.9843
✓ Saved best student model (F1: 0.9921)

Epoch 4/30
Training Student (KL+BCE): 100%|█| 324/324 [07:18<00:00,  1.35s/it, loss=0.493, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.84it/s]
Train Loss: 0.5555 (KL: 0.6880, BCE: 0.2465)
Val Loss: 0.4025, Acc: 0.7626, F1: 0.9071, F1 Fire: 1.0000, F1 Smoke: 0.8143

Epoch 5/30
Training Student (KL+BCE): 100%|█| 324/324 [07:26<00:00,  1.38s/it, loss=0.533, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5541 (KL: 0.6878, BCE: 0.2421)
Val Loss: 0.3294, Acc: 0.8576, F1: 0.9497, F1 Fire: 0.9884, F1 Smoke: 0.9111

Epoch 6/30
Training Student (KL+BCE): 100%|█| 324/324 [07:25<00:00,  1.38s/it, loss=0.598, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5500 (KL: 0.6860, BCE: 0.2326)
Val Loss: 0.5762, Acc: 0.5971, F1: 0.8189, F1 Fire: 1.0000, F1 Smoke: 0.6378

Epoch 7/30
Training Student (KL+BCE): 100%|█| 324/324 [07:25<00:00,  1.38s/it, loss=0.56, k
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5518 (KL: 0.6878, BCE: 0.2344)
Val Loss: 0.4658, Acc: 0.6611, F1: 0.8560, F1 Fire: 1.0000, F1 Smoke: 0.7120

Epoch 8/30
Training Student (KL+BCE): 100%|█| 324/324 [07:22<00:00,  1.36s/it, loss=0.545, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.81it/s]
Train Loss: 0.5486 (KL: 0.6868, BCE: 0.2262)
Val Loss: 0.3787, Acc: 0.7953, F1: 0.9219, F1 Fire: 1.0000, F1 Smoke: 0.8438

Epoch 9/30
Training Student (KL+BCE): 100%|█| 324/324 [07:21<00:00,  1.36s/it, loss=0.539, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.83it/s]
Train Loss: 0.5473 (KL: 0.6862, BCE: 0.2233)
Val Loss: 0.4054, Acc: 0.7619, F1: 0.9068, F1 Fire: 1.0000, F1 Smoke: 0.8136

Epoch 10/30
Training Student (KL+BCE): 100%|█| 324/324 [07:19<00:00,  1.36s/it, loss=0.575, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5483 (KL: 0.6876, BCE: 0.2231)
Val Loss: 0.4021, Acc: 0.7382, F1: 0.9092, F1 Fire: 0.9391, F1 Smoke: 0.8794

Epoch 11/30
Training Student (KL+BCE): 100%|█| 324/324 [07:16<00:00,  1.35s/it, loss=0.539, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5471 (KL: 0.6861, BCE: 0.2228)
Val Loss: 0.2844, Acc: 0.8470, F1: 0.9439, F1 Fire: 1.0000, F1 Smoke: 0.8877

Epoch 12/30
Training Student (KL+BCE): 100%|█| 324/324 [07:16<00:00,  1.35s/it, loss=0.517, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5442 (KL: 0.6851, BCE: 0.2153)
Val Loss: 0.3598, Acc: 0.7974, F1: 0.9228, F1 Fire: 1.0000, F1 Smoke: 0.8456

Epoch 13/30
Training Student (KL+BCE): 100%|█| 324/324 [07:17<00:00,  1.35s/it, loss=0.56, k
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5488 (KL: 0.6886, BCE: 0.2226)
Val Loss: 0.2819, Acc: 0.9130, F1: 0.9696, F1 Fire: 1.0000, F1 Smoke: 0.9391

Epoch 14/30
Training Student (KL+BCE): 100%|█| 324/324 [07:12<00:00,  1.33s/it, loss=0.586, 
Validating Student: 100%|█████████████████████| 205/205 [00:25<00:00,  7.89it/s]
Train Loss: 0.5508 (KL: 0.6903, BCE: 0.2252)
Val Loss: 0.3966, Acc: 0.7616, F1: 0.9066, F1 Fire: 1.0000, F1 Smoke: 0.8133

Epoch 15/30
Training Student (KL+BCE): 100%|█| 324/324 [07:16<00:00,  1.35s/it, loss=0.592, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5474 (KL: 0.6873, BCE: 0.2210)
Val Loss: 0.3993, Acc: 0.7745, F1: 0.9126, F1 Fire: 1.0000, F1 Smoke: 0.8252

Epoch 16/30
Training Student (KL+BCE): 100%|█| 324/324 [07:28<00:00,  1.38s/it, loss=0.559, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5461 (KL: 0.6874, BCE: 0.2164)
Val Loss: 0.3806, Acc: 0.7925, F1: 0.9207, F1 Fire: 1.0000, F1 Smoke: 0.8414

Epoch 17/30
Training Student (KL+BCE): 100%|█| 324/324 [07:23<00:00,  1.37s/it, loss=0.536, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5455 (KL: 0.6872, BCE: 0.2148)
Val Loss: 0.4031, Acc: 0.7638, F1: 0.9077, F1 Fire: 1.0000, F1 Smoke: 0.8153

Epoch 18/30
Training Student (KL+BCE): 100%|█| 324/324 [07:21<00:00,  1.36s/it, loss=0.5, kd
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.85it/s]
Train Loss: 0.5464 (KL: 0.6875, BCE: 0.2170)
Val Loss: 0.3549, Acc: 0.7939, F1: 0.9213, F1 Fire: 1.0000, F1 Smoke: 0.8426

Epoch 19/30
Training Student (KL+BCE): 100%|█| 324/324 [07:19<00:00,  1.36s/it, loss=0.541, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.88it/s]
Train Loss: 0.5473 (KL: 0.6890, BCE: 0.2166)
Val Loss: 0.4011, Acc: 0.7688, F1: 0.9102, F1 Fire: 0.9990, F1 Smoke: 0.8214

Epoch 20/30
Training Student (KL+BCE): 100%|█| 324/324 [07:22<00:00,  1.37s/it, loss=0.585, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5460 (KL: 0.6878, BCE: 0.2151)
Val Loss: 0.3553, Acc: 0.7937, F1: 0.9212, F1 Fire: 1.0000, F1 Smoke: 0.8424

Epoch 21/30
Training Student (KL+BCE): 100%|█| 324/324 [07:25<00:00,  1.38s/it, loss=0.482, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.84it/s]
Train Loss: 0.5466 (KL: 0.6882, BCE: 0.2160)
Val Loss: 0.3564, Acc: 0.7924, F1: 0.9206, F1 Fire: 1.0000, F1 Smoke: 0.8412

Epoch 22/30
Training Student (KL+BCE): 100%|█| 324/324 [07:24<00:00,  1.37s/it, loss=0.502, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.84it/s]
Train Loss: 0.5448 (KL: 0.6866, BCE: 0.2138)
Val Loss: 0.3392, Acc: 0.8040, F1: 0.9257, F1 Fire: 1.0000, F1 Smoke: 0.8515

Epoch 23/30
Training Student (KL+BCE): 100%|█| 324/324 [07:26<00:00,  1.38s/it, loss=0.555, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5467 (KL: 0.6887, BCE: 0.2154)
Val Loss: 0.3370, Acc: 0.8114, F1: 0.9289, F1 Fire: 1.0000, F1 Smoke: 0.8579

Epoch 24/30
Training Student (KL+BCE): 100%|█| 324/324 [07:20<00:00,  1.36s/it, loss=0.53, k
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5476 (KL: 0.6897, BCE: 0.2161)
Val Loss: 0.3564, Acc: 0.7942, F1: 0.9214, F1 Fire: 1.0000, F1 Smoke: 0.8428

Epoch 25/30
Training Student (KL+BCE): 100%|█| 324/324 [07:26<00:00,  1.38s/it, loss=0.57, k
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5471 (KL: 0.6884, BCE: 0.2174)
Val Loss: 0.3659, Acc: 0.7868, F1: 0.9181, F1 Fire: 1.0000, F1 Smoke: 0.8363

Epoch 26/30
Training Student (KL+BCE): 100%|█| 324/324 [07:17<00:00,  1.35s/it, loss=0.515, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5447 (KL: 0.6874, BCE: 0.2120)
Val Loss: 0.3713, Acc: 0.7876, F1: 0.9185, F1 Fire: 1.0000, F1 Smoke: 0.8370

Epoch 27/30
Training Student (KL+BCE): 100%|█| 324/324 [07:21<00:00,  1.36s/it, loss=0.527, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.84it/s]
Train Loss: 0.5463 (KL: 0.6885, BCE: 0.2145)
Val Loss: 0.3952, Acc: 0.7782, F1: 0.9143, F1 Fire: 1.0000, F1 Smoke: 0.8286

Epoch 28/30
Training Student (KL+BCE): 100%|█| 324/324 [07:18<00:00,  1.35s/it, loss=0.459, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5444 (KL: 0.6852, BCE: 0.2159)
Val Loss: 0.3654, Acc: 0.7880, F1: 0.9187, F1 Fire: 1.0000, F1 Smoke: 0.8373

Epoch 29/30
Training Student (KL+BCE): 100%|█| 324/324 [07:18<00:00,  1.35s/it, loss=0.549, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.86it/s]
Train Loss: 0.5446 (KL: 0.6878, BCE: 0.2105)
Val Loss: 0.3632, Acc: 0.7864, F1: 0.9179, F1 Fire: 1.0000, F1 Smoke: 0.8359

Epoch 30/30
Training Student (KL+BCE): 100%|█| 324/324 [07:17<00:00,  1.35s/it, loss=0.518, 
Validating Student: 100%|█████████████████████| 205/205 [00:26<00:00,  7.87it/s]
Train Loss: 0.5440 (KL: 0.6863, BCE: 0.2121)
Val Loss: 0.3442, Acc: 0.7977, F1: 0.9230, F1 Fire: 1.0000, F1 Smoke: 0.8459
Student training completed in 14807.77s
Saved training curves to /kaggle/working/kd_results/graphs/swin-tiny/run_seed_42/student_training_curves.png

--------------------------------------------------------------------------------
MODEL OPTIMIZATION
--------------------------------------------------------------------------------

==================================================
QUANTIZATION
==================================================
Applying dynamic quantization with torchao...
✓ Dynamic quantization applied with torchao

==================================================
PRUNING
==================================================
Applying structured pruning (sparsity=0.4)...
✓ Structured pruning applied
Fine-tuning compressed model for 10 epochs...
Fine-tuning Epoch 1/10: 100%|████| 324/324 [02:42<00:00,  1.99it/s, loss=0.0723]
Epoch 1: Train Loss = 0.0923, Val Loss = 0.1632
Fine-tuning Epoch 2/10: 100%|████| 324/324 [02:42<00:00,  1.99it/s, loss=0.0124]
Epoch 2: Train Loss = 0.0282, Val Loss = 0.1832
Fine-tuning Epoch 3/10:   0%|      | 1/324 [00:02<12:47,  2.38s/it, loss=0.0267]
